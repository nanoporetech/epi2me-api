/**
 * Copyright Metrichor Ltd. (An Oxford Nanopore Technologies Company) 2020
 */

"use strict";function e(e){return e&&"object"===typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("graphql-tag")),r=require("@apollo/client/core"),o=require("cross-fetch"),n=e(o),i=e(require("grpc")),s=e(require("google-protobuf")),a=e(require("google-protobuf/google/protobuf/empty_pb.js")),l=e(require("google-protobuf/google/protobuf/struct_pb.js")),p=require("google-protobuf/google/protobuf/empty_pb"),u=require("rxjs"),c=require("@improbable-eng/grpc-web"),f=require("rxjs/operators");const w="\npage\npages\nhasNext\nhasPrevious\ntotalCount\n",h="\nidWorkflowInstance\nstartDate\nworkflowImage{\n  workflow\n  {\n    rev\n    name\n  }\n}\n";var d="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function g(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}((void 0===t||null===t)&&r.path)}},r.exports),r.exports}var y=g((function(e,t){!function(r){var o=t&&!t.nodeType&&t,n=e&&!e.nodeType&&e,i="object"==typeof d&&d;i.global!==i&&i.window!==i&&i.self!==i||(r=i);var s,a,l=2147483647,p=/^xn--/,u=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=Math.floor,h=String.fromCharCode;function g(e){throw RangeError(f[e])}function y(e,t){for(var r=e.length,o=[];r--;)o[r]=t(e[r]);return o}function m(e,t){var r=e.split("@"),o="";return r.length>1&&(o=r[0]+"@",e=r[1]),o+y((e=e.replace(c,".")).split("."),t).join(".")}function R(e){for(var t,r,o=[],n=0,i=e.length;n<i;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<i?56320==(64512&(r=e.charCodeAt(n++)))?o.push(((1023&t)<<10)+(1023&r)+65536):(o.push(t),n--):o.push(t);return o}function k(e){return y(e,(function(e){var t="";return e>65535&&(t+=h((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=h(e)})).join("")}function I(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function S(e,t,r){var o=0;for(e=r?w(e/700):e>>1,e+=w(e/t);e>455;o+=36)e=w(e/35);return w(o+36*e/(e+38))}function b(e){var t,r,o,n,i,s,a,p,u,c,f,h=[],d=e.length,y=0,m=128,R=72;for((r=e.lastIndexOf("-"))<0&&(r=0),o=0;o<r;++o)e.charCodeAt(o)>=128&&g("not-basic"),h.push(e.charCodeAt(o));for(n=r>0?r+1:0;n<d;){for(i=y,s=1,a=36;n>=d&&g("invalid-input"),((p=(f=e.charCodeAt(n++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:36)>=36||p>w((l-y)/s))&&g("overflow"),y+=p*s,!(p<(u=a<=R?1:a>=R+26?26:a-R));a+=36)s>w(l/(c=36-u))&&g("overflow"),s*=c;R=S(y-i,t=h.length+1,0==i),w(y/t)>l-m&&g("overflow"),m+=w(y/t),y%=t,h.splice(y++,0,m)}return k(h)}function q(e){var t,r,o,n,i,s,a,p,u,c,f,d,y,m,k,b=[];for(d=(e=R(e)).length,t=128,r=0,i=72,s=0;s<d;++s)(f=e[s])<128&&b.push(h(f));for(o=n=b.length,n&&b.push("-");o<d;){for(a=l,s=0;s<d;++s)(f=e[s])>=t&&f<a&&(a=f);for(a-t>w((l-r)/(y=o+1))&&g("overflow"),r+=(a-t)*y,t=a,s=0;s<d;++s)if((f=e[s])<t&&++r>l&&g("overflow"),f==t){for(p=r,u=36;!(p<(c=u<=i?1:u>=i+26?26:u-i));u+=36)k=p-c,m=36-c,b.push(h(I(c+k%m,0))),p=w(k/m);b.push(h(I(p,0))),i=S(r,y,o==n),r=0,++o}++r,++t}return b.join("")}if(s={version:"1.3.2",ucs2:{decode:R,encode:k},decode:b,encode:q,toASCII:function(e){return m(e,(function(e){return u.test(e)?"xn--"+q(e):e}))},toUnicode:function(e){return m(e,(function(e){return p.test(e)?b(e.slice(4).toLowerCase()):e}))}},o&&n)if(e.exports==o)n.exports=s;else for(a in s)s.hasOwnProperty(a)&&(o[a]=s[a]);else r.punycode=s}(d)}));function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var R=function(e,t,r,o){t=t||"&",r=r||"=";var n={};if("string"!==typeof e||0===e.length)return n;var i=/\+/g;e=e.split(t);var s=1e3;o&&"number"===typeof o.maxKeys&&(s=o.maxKeys);var a=e.length;s>0&&a>s&&(a=s);for(var l=0;l<a;++l){var p,u,c,f,w=e[l].replace(i,"%20"),h=w.indexOf(r);h>=0?(p=w.substr(0,h),u=w.substr(h+1)):(p=w,u=""),c=decodeURIComponent(p),f=decodeURIComponent(u),m(n,c)?Array.isArray(n[c])?n[c].push(f):n[c]=[n[c],f]:n[c]=f}return n},k=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},I=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"===typeof e?Object.keys(e).map((function(o){var n=encodeURIComponent(k(o))+r;return Array.isArray(e[o])?e[o].map((function(e){return n+encodeURIComponent(k(e))})).join(t):n+encodeURIComponent(k(e[o]))})).join(t):o?encodeURIComponent(k(o))+r+encodeURIComponent(k(e)):""},S=g((function(e,t){t.decode=t.parse=R,t.encode=t.stringify=I})),b=function(e,t){return T(e,!1,!0).resolve(t)};function q(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var B=/^([a-z0-9.+-]+:)/i,v=/:[0-9]*$/,W=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),M=["'"].concat(W),F=["%","/","?",";","#"].concat(M),j=["/","?","#"],D=/^[a-z0-9A-Z_-]{0,63}$/,A=/^([a-z0-9A-Z_-]{0,63})(.*)$/,O={javascript:!0,"javascript:":!0},z={javascript:!0,"javascript:":!0},E={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function T(e,t,r){if(e&&x(e)&&e instanceof q)return e;var o=new q;return o.parse(e,t,r),o}function $(e){return"string"===typeof e}function x(e){return"object"===typeof e&&null!==e}function C(e){return null===e}q.prototype.parse=function(e,t,r){if(!$(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e;o=o.trim();var n=B.exec(o);if(n){var i=(n=n[0]).toLowerCase();this.protocol=i,o=o.substr(n.length)}if(r||n||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===o.substr(0,2);!s||n&&z[n]||(o=o.substr(2),this.slashes=!0)}if(!z[n]&&(s||n&&!E[n])){for(var a,l,p=-1,u=0;u<j.length;u++){-1!==(c=o.indexOf(j[u]))&&(-1===p||c<p)&&(p=c)}-1!==(l=-1===p?o.lastIndexOf("@"):o.lastIndexOf("@",p))&&(a=o.slice(0,l),o=o.slice(l+1),this.auth=decodeURIComponent(a)),p=-1;for(u=0;u<F.length;u++){var c;-1!==(c=o.indexOf(F[u]))&&(-1===p||c<p)&&(p=c)}-1===p&&(p=o.length),this.host=o.slice(0,p),o=o.slice(p),this.parseHost(),this.hostname=this.hostname||"";var f="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!f)for(var w=this.hostname.split(/\./),h=(u=0,w.length);u<h;u++){var d=w[u];if(d&&!d.match(D)){for(var g="",m=0,R=d.length;m<R;m++)d.charCodeAt(m)>127?g+="x":g+=d[m];if(!g.match(D)){var k=w.slice(0,u),I=w.slice(u+1),b=d.match(A);b&&(k.push(b[1]),I.unshift(b[2])),I.length&&(o="/"+I.join(".")+o),this.hostname=k.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!f){var q=this.hostname.split("."),v=[];for(u=0;u<q.length;++u){var W=q[u];v.push(W.match(/[^A-Za-z0-9_-]/)?"xn--"+y.encode(W):W)}this.hostname=v.join(".")}var T=this.port?":"+this.port:"",x=this.hostname||"";this.host=x+T,this.href+=this.host,f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!O[i])for(u=0,h=M.length;u<h;u++){var C=M[u],U=encodeURIComponent(C);U===C&&(U=escape(C)),o=o.split(C).join(U)}var _=o.indexOf("#");-1!==_&&(this.hash=o.substr(_),o=o.slice(0,_));var P=o.indexOf("?");if(-1!==P?(this.search=o.substr(P),this.query=o.substr(P+1),t&&(this.query=S.parse(this.query)),o=o.slice(0,P)):t&&(this.search="",this.query={}),o&&(this.pathname=o),E[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){T=this.pathname||"",W=this.search||"";this.path=T+W}return this.href=this.format(),this},q.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",o=this.hash||"",n=!1,i="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&x(this.query)&&Object.keys(this.query).length&&(i=S.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||E[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),o&&"#"!==o.charAt(0)&&(o="#"+o),s&&"?"!==s.charAt(0)&&(s="?"+s),t+n+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+o},q.prototype.resolve=function(e){return this.resolveObject(T(e,!1,!0)).format()},q.prototype.resolveObject=function(e){if($(e)){var t=new q;t.parse(e,!1,!0),e=t}var r=new q;if(Object.keys(this).forEach((function(e){r[e]=this[e]}),this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){"protocol"!==t&&(r[t]=e[t])})),E[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!E[e.protocol])return Object.keys(e).forEach((function(t){r[t]=e[t]})),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||z[e.protocol])r.pathname=e.pathname;else{for(var o=(e.pathname||"").split("/");o.length&&!(e.host=o.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),r.pathname=o.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var n=r.pathname||"",i=r.search||"";r.path=n+i}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var s=r.pathname&&"/"===r.pathname.charAt(0),a=e.host||e.pathname&&"/"===e.pathname.charAt(0),l=a||s||r.host&&e.pathname,p=l,u=r.pathname&&r.pathname.split("/")||[],c=(o=e.pathname&&e.pathname.split("/")||[],r.protocol&&!E[r.protocol]);if(c&&(r.hostname="",r.port=null,r.host&&(""===u[0]?u[0]=r.host:u.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===o[0]?o[0]=e.host:o.unshift(e.host)),e.host=null),l=l&&(""===o[0]||""===u[0])),a)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,u=o;else if(o.length)u||(u=[]),u.pop(),u=u.concat(o),r.search=e.search,r.query=e.query;else if(null!=e.search){if(c)r.hostname=r.host=u.shift(),(g=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=g.shift(),r.host=r.hostname=g.shift());return r.search=e.search,r.query=e.query,C(r.pathname)&&C(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!u.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var f=u.slice(-1)[0],w=(r.host||e.host)&&("."===f||".."===f)||""===f,h=0,d=u.length;d>=0;d--)"."==(f=u[d])?u.splice(d,1):".."===f?(u.splice(d,1),h++):h&&(u.splice(d,1),h--);if(!l&&!p)for(;h--;h)u.unshift("..");!l||""===u[0]||u[0]&&"/"===u[0].charAt(0)||u.unshift(""),w&&"/"!==u.join("/").substr(-1)&&u.push("");var g,y=""===u[0]||u[0]&&"/"===u[0].charAt(0);c&&(r.hostname=r.host=y?"":u.length?u.shift():"",(g=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=g.shift(),r.host=r.hostname=g.shift()));return(l=l||r.host&&u.length)&&!y&&u.unshift(""),u.length?r.pathname=u.join("/"):(r.pathname=null,r.path=null),C(r.pathname)&&C(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},q.prototype.parseHost=function(){var e=this.host,t=v.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};function U(e){return null!==e&&"object"===typeof e&&!1===Array.isArray(e)}function _(e,t){if(function(e){return"boolean"===typeof e}(e))return e;if(function(e){return null===e||"undefined"===typeof e}(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Boolean`)}let P=n;async function L(e,t=!1){const r=await(t?async function(e){try{return await e.json()}catch(t){return null}}(e):e.json());if(U(r)&&"string"===typeof r.error)throw new Error(r.error);return r}function N(e={}){var t,r;const n=new o.Headers;if(n.set("Accept","application/json"),n.set("Content-Type","application/json"),n.set("X-EPI2ME-Client",null!==(t=e.user_agent)&&void 0!==t?t:"api"),n.set("X-EPI2ME-Version",null!==(r=e.agent_version)&&void 0!==r?r:"3.0.1238"),e.headers)for(const[o,i]of Object.entries(e.headers))n.set(o,i);return n}async function G(e,t){var r;const n=N(t),i=new URL(e,t.base_url),s={headers:n,method:null!==(r=t.method)&&void 0!==r?r:"get",agent:t.agent,body:t.body};let a=new o.Request(i.toString(),s);t.mutate_request&&(a=await t.mutate_request(a)),t.log&&t.log(a);let l=await P(a);return await async function(e){if(!e.ok){if(504===e.status)throw new Error("Please check your network connection and try again");throw await L(e,!0),new Error("Network error: "+e.statusText)}}(l),t.mutate_response&&(l=await t.mutate_response(l)),l}function H(e,t){if(U(e)){if("json"===t)return JSON.stringify(e);if("url"===t){const t=new URLSearchParams;for(const r of Object.keys(e))t.set(r,String(e[r]));return t.set("json",JSON.stringify(e)),t.sort(),t}throw new Error("Invalid body encoding method "+t)}return e}const J={head:(e,t={})=>G(e,Object.assign(Object.assign({},t),{method:"head"})),get:async(e,t={})=>L(await G(e,Object.assign(Object.assign({},t),{method:"get"}))),async post(e,t,r={}){var o;const n=H(t,null!==(o=r.encode_method)&&void 0!==o?o:"json");return L(await G(e,Object.assign(Object.assign({},r),{body:n,method:"post"})))},async put(e,t,r={}){var o;const n=H(t,null!==(o=r.encode_method)&&void 0!==o?o:"json");return L(await G(e,Object.assign(Object.assign({},r),{body:n,method:"put"})))}},K=(...e)=>{};class V{constructor(e){this.initClient=()=>function(e){const t=new r.ApolloLink(t=>{const o=e(),{url:n}=t.getContext(),i=r.createHttpLink({uri:b(n,"/graphql"),fetch:o});return r.execute(i,t)}),o=new r.InMemoryCache;return new r.ApolloClient({link:t,cache:o})}(()=>(e,t={})=>{const r=N({headers:new o.Headers(t.headers)});return r.set("Authorization","Bearer "+this.options.jwt),t.headers=r,n(e,t)}),this.createContext=e=>{const{url:t,apikey:r,apisecret:o}=this.options;return Object.assign({apikey:r,apisecret:o,url:t},e)},this.resetCache=()=>{this.client.resetStore()},this.workflows=this.query(t`
    query allWorkflows($page: Int, $pageSize: Int, $isActive: Int, $orderBy: String, $region: String) {
      allWorkflows(page: $page, pageSize: $pageSize, isActive: $isActive, orderBy: $orderBy, region: $region) {
        ${w}
        results {
          ${"\nidWorkflow\nname\ndescription\nsummary\nrev\n"}
        }
      }
    }
  `),this.workflowPages=async e=>{let t=e,r=await this.workflows({variables:{page:t}});const o=async e=>(t=e,r=await this.workflows({variables:{page:t}}),r);return{data:r,next:()=>o(t+1),previous:()=>o(t-1),first:()=>o(1),last:()=>o(0)}},this.workflow=this.query(t`
    query workflow($idWorkflow: ID!) {
      workflow(idWorkflow: $idWorkflow) {
        ${"\nidWorkflow\nname\ndescription\nsummary\nrev\n"}
      }
    }
   `),this.workflowInstances=this.query(t`
  query allWorkflowInstances($page: Int, $pageSize: Int, $shared: Boolean, $idUser: ID, $orderBy: String) {
    allWorkflowInstances(page: $page, pageSize: $pageSize, shared: $shared, idUser: $idUser, orderBy: $orderBy) {
      ${w}
      results {
        ${h}
      }
    }
  }
   `),this.workflowInstance=this.query(t`
      query workflowInstance($idWorkflowInstance: ID!) {
        workflowInstance(idWorkflowInstance: $idWorkflowInstance) {
          ${h}
        }
      }
   `),this.startWorkflow=this.mutate(t`
    mutation startWorkflow(
      $idWorkflow: ID!
      $computeAccountId: ID!
      $storageAccountId: ID
      $isConsentedHuman: Boolean = false
      $idDataset: ID
      $storeResults: Boolean = false
      $userDefined: GenericScalar
      $instanceAttributes: [GenericScalar]
      $region: String
    ) {
      startData: startWorkflowInstance(
        idWorkflow: $idWorkflow
        computeAccountId: $computeAccountId
        storageAccountId: $storageAccountId
        isConsentedHuman: $isConsentedHuman
        idDataset: $idDataset
        storeResults: $storeResults
        userDefined: $userDefined
        instanceAttributes: $instanceAttributes
        region: $region
      ) {
        bucket
        idUser
        remoteAddr
        instance {
          idWorkflowInstance
          chain
          keyId
          outputqueue
          mappedTelemetry
          workflowImage {
            inputqueue
            workflow {
              idWorkflow
            }
            region {
              name
            }
          }
        }
      }
    }
  `),this.stopWorkflow=this.mutate(t`
    mutation stopWorkflowInstance($idWorkflowInstance: ID!) {
      stopData: stopWorkflowInstance(idWorkflowInstance: $idWorkflowInstance) {
        success
        message
      }
    }
  `),this.instanceToken=this.mutate(t`
    mutation getInstanceToken($idWorkflowInstance: ID!) {
      token: getInstanceToken(idWorkflowInstance: $idWorkflowInstance) {
        id_workflow_instance: idWorkflowInstance
        accessKeyId
        secretAccessKey
        sessionToken
        expiration
        region
      }
    }
  `),this.user=this.query(t`
    query user {
      me {
        username
        realname
        useraccountSet {
          idUserAccount
        }
      }
    }
  `),this.updateUser=this.mutate(t`
    mutation updateUser($idRegionPreferred: ID!) {
      updateUser(idRegionPreferred: $idRegionPreferred) {
        idRegionPreferred
      }
    }
  `),this.register=this.mutate(t`
    mutation registerToken($code: String!, $description: String) {
      registerToken(code: $code, description: $description) {
        apikey
        apisecret
        description
      }
    }
  `),this.status=this.query(t`
    query status {
      status {
        portalVersion
        remoteAddr
        serverTime
        minimumAgent
        dbVersion
      }
    }
  `),this.regions=this.query(t`
    query regions {
      regions {
        idRegion
        description
        name
      }
    }
  `);let i=e.url;i=i.replace(/:\/\//,"://graphql."),i=i.replace(/\/$/,"");const{apikey:s,apisecret:a,jwt:l,log:p,local:u,signing:c}=e;this.options={url:i,base_url:i,agent_version:e.agent_version,local:u,user_agent:e.user_agent,signing:c,apikey:s,apisecret:a,jwt:l},this.log=p,this.client=this.initClient()}query(e){return r=>{var o,n,i;const s=null!==(o=null===r||void 0===r?void 0:r.context)&&void 0!==o?o:{},a=null!==(n=null===r||void 0===r?void 0:r.variables)&&void 0!==n?n:{},l=null!==(i=null===r||void 0===r?void 0:r.options)&&void 0!==i?i:{},p=this.createContext(s);let u;return u="string"===typeof e?t`
          ${e}
        `:"function"===typeof e?t`
          ${e(w)}
        `:e,this.client.query(Object.assign(Object.assign({query:u,variables:a},l),{context:p}))}}mutate(e){return r=>{var o,n,i;const s=null!==(o=null===r||void 0===r?void 0:r.context)&&void 0!==o?o:{},a=null!==(n=null===r||void 0===r?void 0:r.variables)&&void 0!==n?n:{},l=null!==(i=null===r||void 0===r?void 0:r.options)&&void 0!==i?i:{},p=this.createContext(s);let u;return u="string"===typeof e?t`
          ${e}
        `:e,this.client.mutate(Object.assign(Object.assign({mutation:u,variables:a},l),{context:p}))}}async convertONTJWT(e,t={token_type:"jwt"}){if("jwt"!==t.token_type&&!t.description)throw new Error("Description required for signature requests");return J.post("convert-ont",t,Object.assign(Object.assign({},this.options),{log:K,headers:{"X-ONT-JWT":e}}))}async healthCheck(){return{status:_((await J.get("/status",Object.assign(Object.assign({},this.options),{log:K}))).status)}}}V.NETWORK_ONLY="network-only",V.CACHE_FIRST="cache-first",V.CACHE_AND_NETWORK="cache-and-network",V.CACHE_ONLY="cache-only",V.NO_CACHE="no-cache";var X=g((function(e,t){var r=s,o=Function("return this")();r.object.extend(proto,a),r.object.extend(proto,l),r.exportSymbol("proto.epi2me.workflow.RunningInstanceStateReply",null,o),r.exportSymbol("proto.epi2me.workflow.RunningInstancesReply",null,o),r.exportSymbol("proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails",null,o),r.exportSymbol("proto.epi2me.workflow.StartReply",null,o),r.exportSymbol("proto.epi2me.workflow.StartRequest",null,o),r.exportSymbol("proto.epi2me.workflow.StartRequest.InstanceAttribute",null,o),r.exportSymbol("proto.epi2me.workflow.StopReply",null,o),r.exportSymbol("proto.epi2me.workflow.WorkflowInstanceByIdRequest",null,o),proto.epi2me.workflow.StartRequest=function(e){s.Message.initialize(this,e,0,-1,proto.epi2me.workflow.StartRequest.repeatedFields_,null)},r.inherits(proto.epi2me.workflow.StartRequest,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartRequest.displayName="proto.epi2me.workflow.StartRequest"),proto.epi2me.workflow.StartRequest.InstanceAttribute=function(e){s.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StartRequest.InstanceAttribute,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartRequest.InstanceAttribute.displayName="proto.epi2me.workflow.StartRequest.InstanceAttribute"),proto.epi2me.workflow.StartReply=function(e){s.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StartReply,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartReply.displayName="proto.epi2me.workflow.StartReply"),proto.epi2me.workflow.RunningInstancesReply=function(e){s.Message.initialize(this,e,0,-1,proto.epi2me.workflow.RunningInstancesReply.repeatedFields_,null)},r.inherits(proto.epi2me.workflow.RunningInstancesReply,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstancesReply.displayName="proto.epi2me.workflow.RunningInstancesReply"),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails=function(e){s.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.displayName="proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails"),proto.epi2me.workflow.WorkflowInstanceByIdRequest=function(e){s.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.WorkflowInstanceByIdRequest,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.WorkflowInstanceByIdRequest.displayName="proto.epi2me.workflow.WorkflowInstanceByIdRequest"),proto.epi2me.workflow.RunningInstanceStateReply=function(e){s.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.RunningInstanceStateReply,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstanceStateReply.displayName="proto.epi2me.workflow.RunningInstanceStateReply"),proto.epi2me.workflow.StopReply=function(e){s.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StopReply,s.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StopReply.displayName="proto.epi2me.workflow.StopReply"),proto.epi2me.workflow.StartRequest.repeatedFields_=[5,25],s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartRequest.prototype.toObject=function(e){return proto.epi2me.workflow.StartRequest.toObject(e,this)},proto.epi2me.workflow.StartRequest.toObject=function(e,t){var r,o={apikey:s.Message.getFieldWithDefault(t,1,""),apisecret:s.Message.getFieldWithDefault(t,2,""),url:s.Message.getFieldWithDefault(t,3,""),inputfoldersList:null==(r=s.Message.getRepeatedField(t,5))?void 0:r,outputfolder:s.Message.getFieldWithDefault(t,6,""),idworkflow:s.Message.getFieldWithDefault(t,10,""),computeaccountid:s.Message.getFieldWithDefault(t,11,""),storageaccountid:s.Message.getFieldWithDefault(t,20,""),isconsentedhuman:s.Message.getBooleanFieldWithDefault(t,21,!1),iddataset:s.Message.getFieldWithDefault(t,22,""),storeresults:s.Message.getBooleanFieldWithDefault(t,23,!1),userdefined:(r=t.getUserdefined())&&l.Struct.toObject(e,r),instanceattributesList:s.Message.toObjectList(t.getInstanceattributesList(),proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject,e),region:s.Message.getFieldWithDefault(t,26,"")};return e&&(o.$jspbMessageInstance=t),o}),proto.epi2me.workflow.StartRequest.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.StartRequest;return proto.epi2me.workflow.StartRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setApikey(r);break;case 2:r=t.readString();e.setApisecret(r);break;case 3:r=t.readString();e.setUrl(r);break;case 5:r=t.readString();e.addInputfolders(r);break;case 6:r=t.readString();e.setOutputfolder(r);break;case 10:r=t.readString();e.setIdworkflow(r);break;case 11:r=t.readString();e.setComputeaccountid(r);break;case 20:r=t.readString();e.setStorageaccountid(r);break;case 21:r=t.readBool();e.setIsconsentedhuman(r);break;case 22:r=t.readString();e.setIddataset(r);break;case 23:r=t.readBool();e.setStoreresults(r);break;case 24:r=new l.Struct;t.readMessage(r,l.Struct.deserializeBinaryFromReader),e.setUserdefined(r);break;case 25:r=new proto.epi2me.workflow.StartRequest.InstanceAttribute;t.readMessage(r,proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader),e.addInstanceattributes(r);break;case 26:r=t.readString();e.setRegion(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartRequest.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.StartRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartRequest.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getApikey()).length>0&&t.writeString(1,r),(r=e.getApisecret()).length>0&&t.writeString(2,r),(r=e.getUrl()).length>0&&t.writeString(3,r),(r=e.getInputfoldersList()).length>0&&t.writeRepeatedString(5,r),(r=e.getOutputfolder()).length>0&&t.writeString(6,r),(r=e.getIdworkflow()).length>0&&t.writeString(10,r),(r=e.getComputeaccountid()).length>0&&t.writeString(11,r),(r=e.getStorageaccountid()).length>0&&t.writeString(20,r),(r=e.getIsconsentedhuman())&&t.writeBool(21,r),(r=e.getIddataset()).length>0&&t.writeString(22,r),(r=e.getStoreresults())&&t.writeBool(23,r),null!=(r=e.getUserdefined())&&t.writeMessage(24,r,l.Struct.serializeBinaryToWriter),(r=e.getInstanceattributesList()).length>0&&t.writeRepeatedMessage(25,r,proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter),(r=e.getRegion()).length>0&&t.writeString(26,r)},s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.toObject=function(e){return proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject(e,this)},proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject=function(e,t){var r={idAttribute:s.Message.getFieldWithDefault(t,1,0),value:s.Message.getFieldWithDefault(t,2,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.StartRequest.InstanceAttribute;return proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readUint32();e.setIdAttribute(r);break;case 2:r=t.readString();e.setValue(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter=function(e,t){var r=void 0;0!==(r=e.getIdAttribute())&&t.writeUint32(1,r),(r=e.getValue()).length>0&&t.writeString(2,r)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.getIdAttribute=function(){return s.Message.getFieldWithDefault(this,1,0)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.setIdAttribute=function(e){return s.Message.setProto3IntField(this,1,e)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.getValue=function(){return s.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.setValue=function(e){return s.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.StartRequest.prototype.getApikey=function(){return s.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.StartRequest.prototype.setApikey=function(e){return s.Message.setProto3StringField(this,1,e)},proto.epi2me.workflow.StartRequest.prototype.getApisecret=function(){return s.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartRequest.prototype.setApisecret=function(e){return s.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.StartRequest.prototype.getUrl=function(){return s.Message.getFieldWithDefault(this,3,"")},proto.epi2me.workflow.StartRequest.prototype.setUrl=function(e){return s.Message.setProto3StringField(this,3,e)},proto.epi2me.workflow.StartRequest.prototype.getInputfoldersList=function(){return s.Message.getRepeatedField(this,5)},proto.epi2me.workflow.StartRequest.prototype.setInputfoldersList=function(e){return s.Message.setField(this,5,e||[])},proto.epi2me.workflow.StartRequest.prototype.addInputfolders=function(e,t){return s.Message.addToRepeatedField(this,5,e,t)},proto.epi2me.workflow.StartRequest.prototype.clearInputfoldersList=function(){return this.setInputfoldersList([])},proto.epi2me.workflow.StartRequest.prototype.getOutputfolder=function(){return s.Message.getFieldWithDefault(this,6,"")},proto.epi2me.workflow.StartRequest.prototype.setOutputfolder=function(e){return s.Message.setProto3StringField(this,6,e)},proto.epi2me.workflow.StartRequest.prototype.getIdworkflow=function(){return s.Message.getFieldWithDefault(this,10,"")},proto.epi2me.workflow.StartRequest.prototype.setIdworkflow=function(e){return s.Message.setProto3StringField(this,10,e)},proto.epi2me.workflow.StartRequest.prototype.getComputeaccountid=function(){return s.Message.getFieldWithDefault(this,11,"")},proto.epi2me.workflow.StartRequest.prototype.setComputeaccountid=function(e){return s.Message.setProto3StringField(this,11,e)},proto.epi2me.workflow.StartRequest.prototype.getStorageaccountid=function(){return s.Message.getFieldWithDefault(this,20,"")},proto.epi2me.workflow.StartRequest.prototype.setStorageaccountid=function(e){return s.Message.setProto3StringField(this,20,e)},proto.epi2me.workflow.StartRequest.prototype.getIsconsentedhuman=function(){return s.Message.getBooleanFieldWithDefault(this,21,!1)},proto.epi2me.workflow.StartRequest.prototype.setIsconsentedhuman=function(e){return s.Message.setProto3BooleanField(this,21,e)},proto.epi2me.workflow.StartRequest.prototype.getIddataset=function(){return s.Message.getFieldWithDefault(this,22,"")},proto.epi2me.workflow.StartRequest.prototype.setIddataset=function(e){return s.Message.setProto3StringField(this,22,e)},proto.epi2me.workflow.StartRequest.prototype.getStoreresults=function(){return s.Message.getBooleanFieldWithDefault(this,23,!1)},proto.epi2me.workflow.StartRequest.prototype.setStoreresults=function(e){return s.Message.setProto3BooleanField(this,23,e)},proto.epi2me.workflow.StartRequest.prototype.getUserdefined=function(){return s.Message.getWrapperField(this,l.Struct,24)},proto.epi2me.workflow.StartRequest.prototype.setUserdefined=function(e){return s.Message.setWrapperField(this,24,e)},proto.epi2me.workflow.StartRequest.prototype.clearUserdefined=function(){return this.setUserdefined(void 0)},proto.epi2me.workflow.StartRequest.prototype.hasUserdefined=function(){return null!=s.Message.getField(this,24)},proto.epi2me.workflow.StartRequest.prototype.getInstanceattributesList=function(){return s.Message.getRepeatedWrapperField(this,proto.epi2me.workflow.StartRequest.InstanceAttribute,25)},proto.epi2me.workflow.StartRequest.prototype.setInstanceattributesList=function(e){return s.Message.setRepeatedWrapperField(this,25,e)},proto.epi2me.workflow.StartRequest.prototype.addInstanceattributes=function(e,t){return s.Message.addToRepeatedWrapperField(this,25,e,proto.epi2me.workflow.StartRequest.InstanceAttribute,t)},proto.epi2me.workflow.StartRequest.prototype.clearInstanceattributesList=function(){return this.setInstanceattributesList([])},proto.epi2me.workflow.StartRequest.prototype.getRegion=function(){return s.Message.getFieldWithDefault(this,26,"")},proto.epi2me.workflow.StartRequest.prototype.setRegion=function(e){return s.Message.setProto3StringField(this,26,e)},s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartReply.prototype.toObject=function(e){return proto.epi2me.workflow.StartReply.toObject(e,this)},proto.epi2me.workflow.StartReply.toObject=function(e,t){var r={started:s.Message.getBooleanFieldWithDefault(t,1,!1),idworkflowinstance:s.Message.getFieldWithDefault(t,2,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StartReply.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.StartReply;return proto.epi2me.workflow.StartReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setStarted(r);break;case 2:r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartReply.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.StartReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartReply.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getStarted())&&t.writeBool(1,r),(r=e.getIdworkflowinstance()).length>0&&t.writeString(2,r)},proto.epi2me.workflow.StartReply.prototype.getStarted=function(){return s.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.StartReply.prototype.setStarted=function(e){return s.Message.setProto3BooleanField(this,1,e)},proto.epi2me.workflow.StartReply.prototype.getIdworkflowinstance=function(){return s.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartReply.prototype.setIdworkflowinstance=function(e){return s.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.RunningInstancesReply.repeatedFields_=[1],s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstancesReply.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstancesReply.toObject(e,this)},proto.epi2me.workflow.RunningInstancesReply.toObject=function(e,t){var r={workflowinstanceList:s.Message.toObjectList(t.getWorkflowinstanceList(),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject,e)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstancesReply.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstancesReply;return proto.epi2me.workflow.RunningInstancesReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstancesReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=new proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails;t.readMessage(r,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader),e.addWorkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstancesReply.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.RunningInstancesReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstancesReply.serializeBinaryToWriter=function(e,t){var r;(r=e.getWorkflowinstanceList()).length>0&&t.writeRepeatedMessage(1,r,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter)},s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject(e,this)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject=function(e,t){var r={idworkflowinstance:s.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails;return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter=function(e,t){var r;(r=e.getIdworkflowinstance()).length>0&&t.writeString(1,r)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.getIdworkflowinstance=function(){return s.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.setIdworkflowinstance=function(e){return s.Message.setProto3StringField(this,1,e)},proto.epi2me.workflow.RunningInstancesReply.prototype.getWorkflowinstanceList=function(){return s.Message.getRepeatedWrapperField(this,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,1)},proto.epi2me.workflow.RunningInstancesReply.prototype.setWorkflowinstanceList=function(e){return s.Message.setRepeatedWrapperField(this,1,e)},proto.epi2me.workflow.RunningInstancesReply.prototype.addWorkflowinstance=function(e,t){return s.Message.addToRepeatedWrapperField(this,1,e,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,t)},proto.epi2me.workflow.RunningInstancesReply.prototype.clearWorkflowinstanceList=function(){return this.setWorkflowinstanceList([])},s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.toObject=function(e){return proto.epi2me.workflow.WorkflowInstanceByIdRequest.toObject(e,this)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.toObject=function(e,t){var r={idworkflowinstance:s.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.WorkflowInstanceByIdRequest;return proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.WorkflowInstanceByIdRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.WorkflowInstanceByIdRequest.serializeBinaryToWriter=function(e,t){var r;(r=e.getIdworkflowinstance()).length>0&&t.writeString(1,r)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.getIdworkflowinstance=function(){return s.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.setIdworkflowinstance=function(e){return s.Message.setProto3StringField(this,1,e)},s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstanceStateReply.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstanceStateReply.toObject(e,this)},proto.epi2me.workflow.RunningInstanceStateReply.toObject=function(e,t){var r={upload:s.Message.getBooleanFieldWithDefault(t,1,!1),analyse:s.Message.getBooleanFieldWithDefault(t,2,!1),report:s.Message.getBooleanFieldWithDefault(t,3,!1)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstanceStateReply;return proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setUpload(r);break;case 2:r=t.readBool();e.setAnalyse(r);break;case 3:r=t.readBool();e.setReport(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstanceStateReply.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.RunningInstanceStateReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstanceStateReply.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getUpload())&&t.writeBool(1,r),(r=e.getAnalyse())&&t.writeBool(2,r),(r=e.getReport())&&t.writeBool(3,r)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getUpload=function(){return s.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setUpload=function(e){return s.Message.setProto3BooleanField(this,1,e)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getAnalyse=function(){return s.Message.getBooleanFieldWithDefault(this,2,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setAnalyse=function(e){return s.Message.setProto3BooleanField(this,2,e)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getReport=function(){return s.Message.getBooleanFieldWithDefault(this,3,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setReport=function(e){return s.Message.setProto3BooleanField(this,3,e)},s.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StopReply.prototype.toObject=function(e){return proto.epi2me.workflow.StopReply.toObject(e,this)},proto.epi2me.workflow.StopReply.toObject=function(e,t){var r={success:s.Message.getBooleanFieldWithDefault(t,1,!1)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StopReply.deserializeBinary=function(e){var t=new s.BinaryReader(e),r=new proto.epi2me.workflow.StopReply;return proto.epi2me.workflow.StopReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StopReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setSuccess(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StopReply.prototype.serializeBinary=function(){var e=new s.BinaryWriter;return proto.epi2me.workflow.StopReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StopReply.serializeBinaryToWriter=function(e,t){var r;(r=e.getSuccess())&&t.writeBool(1,r)},proto.epi2me.workflow.StopReply.prototype.getSuccess=function(){return s.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.StopReply.prototype.setSuccess=function(e){return s.Message.setProto3BooleanField(this,1,e)},r.object.extend(t,proto.epi2me.workflow)})),Z=g((function(e,t){function r(e){if(!(e instanceof X.StopReply))throw new Error("Expected argument of type epi2me.workflow.StopReply");return Buffer.from(e.serializeBinary())}function o(e){return X.StopReply.deserializeBinary(new Uint8Array(e))}function n(e){if(!(e instanceof X.WorkflowInstanceByIdRequest))throw new Error("Expected argument of type epi2me.workflow.WorkflowInstanceByIdRequest");return Buffer.from(e.serializeBinary())}function s(e){return X.WorkflowInstanceByIdRequest.deserializeBinary(new Uint8Array(e))}var l=t.WorkflowService={start:{path:"/epi2me.workflow.Workflow/start",requestStream:!1,responseStream:!1,requestType:X.StartRequest,responseType:X.StartReply,requestSerialize:function(e){if(!(e instanceof X.StartRequest))throw new Error("Expected argument of type epi2me.workflow.StartRequest");return Buffer.from(e.serializeBinary())},requestDeserialize:function(e){return X.StartRequest.deserializeBinary(new Uint8Array(e))},responseSerialize:function(e){if(!(e instanceof X.StartReply))throw new Error("Expected argument of type epi2me.workflow.StartReply");return Buffer.from(e.serializeBinary())},responseDeserialize:function(e){return X.StartReply.deserializeBinary(new Uint8Array(e))}},stopUpload:{path:"/epi2me.workflow.Workflow/stopUpload",requestStream:!1,responseStream:!1,requestType:X.WorkflowInstanceByIdRequest,responseType:X.StopReply,requestSerialize:n,requestDeserialize:s,responseSerialize:r,responseDeserialize:o},stopAnalysis:{path:"/epi2me.workflow.Workflow/stopAnalysis",requestStream:!1,responseStream:!1,requestType:X.WorkflowInstanceByIdRequest,responseType:X.StopReply,requestSerialize:n,requestDeserialize:s,responseSerialize:r,responseDeserialize:o},running:{path:"/epi2me.workflow.Workflow/running",requestStream:!1,responseStream:!0,requestType:a.Empty,responseType:X.RunningInstancesReply,requestSerialize:function(e){if(!(e instanceof a.Empty))throw new Error("Expected argument of type google.protobuf.Empty");return Buffer.from(e.serializeBinary())},requestDeserialize:function(e){return a.Empty.deserializeBinary(new Uint8Array(e))},responseSerialize:function(e){if(!(e instanceof X.RunningInstancesReply))throw new Error("Expected argument of type epi2me.workflow.RunningInstancesReply");return Buffer.from(e.serializeBinary())},responseDeserialize:function(e){return X.RunningInstancesReply.deserializeBinary(new Uint8Array(e))}},instanceRunningState:{path:"/epi2me.workflow.Workflow/instanceRunningState",requestStream:!1,responseStream:!0,requestType:X.WorkflowInstanceByIdRequest,responseType:X.RunningInstanceStateReply,requestSerialize:n,requestDeserialize:s,responseSerialize:function(e){if(!(e instanceof X.RunningInstanceStateReply))throw new Error("Expected argument of type epi2me.workflow.RunningInstanceStateReply");return Buffer.from(e.serializeBinary())},responseDeserialize:function(e){return X.RunningInstanceStateReply.deserializeBinary(new Uint8Array(e))}}};t.WorkflowClient=i.makeGenericClientConstructor(l)}));const Y=c.grpc.Code;function Q(e,t,r,o){const{grpcUrl:n,request:i,service:s}=o;t!==Y.OK&&t!==Y.Aborted&&e.error({code:t,code_text:Y[t],host:n,message:r,request:i,service:s.name})}function ee({tokens:e}){const t=new c.grpc.Metadata;return t.set("jwt",e.jwt),t}function te(e,t,r,o,n=!1){const i={grpcUrl:e,tokens:t,service:r,request:o};return u.Observable.create(t=>{if(!e)return t.error({message:"No grpc URL provided"}),u.of(null);const r=n?function(e,t){const{grpcUrl:r,request:o,service:n,tokens:i}=t;return c.grpc.invoke(n,{host:r,metadata:ee({tokens:i}),onEnd:(r,o)=>{Q(e,r,o,t),e.complete()},onMessage:t=>{t&&e.next(t)},request:o})}(t,i):function(e,t){const{grpcUrl:r,request:o,service:n,tokens:i}=t;return c.grpc.unary(n,{host:r,metadata:ee({tokens:i}),onEnd:({status:r,message:o})=>{o&&e.next(o),Q(e,r,o,t),e.complete()},request:o})}(t,i);return()=>{r.close(),t.complete()}})}c.grpc.setDefaultTransport(c.grpc.FetchReadableStreamTransport({credentials:"omit"}));class re{constructor(e,t){this._url=e,this._jwt=t,this._destroySubs$=new u.Subject}close(){this._destroySubs$.next()}getRunning$(){const e=new p.Empty;return te(this._url,{jwt:this._jwt},Z.WorkflowService.running,e,!0).pipe(f.map(e=>e.toObject()),f.takeUntil(this._destroySubs$))}}exports.EPI2ME_RPC=class{constructor(e,t){this.url=e,this.workflowApi=new re(e,t)}close(){this.workflowApi.close()}},exports.GraphQL=V;
